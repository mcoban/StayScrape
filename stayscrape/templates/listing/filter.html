{% load static %}
{% load rental_filters %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">


	<title>{% if place.meta_title %}{{ place.meta_title }}{% else %}Villas in {{ place.name }} | StayScrape{% endif %}</title>
	<meta name="description" content="Top 15 Villas Holidays in Europe.">

	<link rel="stylesheet" href="{% static "css/bootstrap.min.css" %}">
	<link rel="stylesheet" href="{% static "css/custom.css" %}">
	<link rel="icon" type="image/png" sizes="32x32" href="{% static "img/favicon.png" %}">
	{% if pagination.page > 1 %}
	<meta name="robot" content="noindex, follow">
	{% else %}
	<meta name="robot" content="index, follow">
	{% endif %}
</head>

<body id="listing">
	
	<nav class="navbar navbar-stayScrape">
		<div class="container">
			<div class="navbar-header">
				<a href="{{ settings.SITE_URL }}" class="navbar-brand"></a>
			</div>
			<ul class="nav navbar-nav navbar-right">
				<li><a href="#">Destinaions</a></li>
				<li><a href="#">Places</a></li>
				<li><a href="#">Blog</a></li>
			</ul>
		</div>
	</nav>
	<div class="filter-bar">
		<div class="container-fluid">
			<div class="row">
				<div class="col-xs-18 col-sm-7 col-md-5">
					<div class="input-container" id="place-input-container">
						<input type="text" class="place-input" placeholder="Type a place that you want to stay">
						<i class="icon search right"></i>
					</div>
				</div>
				<div class="col-sm-2 col-xs-5">
					<div class="input-container" id="guest-container">
						<i class="icon left guest"></i>
						<select name="guests" id="guest">
							<option value="" disabled selected>Guests</option>
							<option value="1">1 Guest</option>
							<option value="2">2 Guests</option>
							<option value="3">3 Guests</option>
							<option value="4">4 Guests</option>
							<option value="5">5 Guests</option>
							<option value="5+">5+ Guests</option>
						</select>
					</div>
				</div>
				<div class="col-sm-3 col-xs-18">
					<a href="#" class="btn search-button">Search</a>
				</div>
			</div>
		</div>
	</div>



	<div class="container-fluid">
		<div class="row">
			<div class="col-md-8">
				<div class="sortby-filter">
					{% if place.page_title %}
					<h1 class="page-title">{{ place.page_title }}</h1>
					{% else %}
					<h1 class="page-title">Villas in {{ place.name }}</h1>
					{% endif %}
					<span class="count">{{ pagination.start }}-{{ pagination.end }} of {{ place.count }} Holiday Villas</span>
				</div>

				<div class="villas">
					<div class="row">
{% for rental in rentals %}
						<div class="col-md-4">
							<a href="{{ settings.SITE_URL }}/villa/{{ rental.id }}" class="villa" target="_blank">
								<div class="img-container" style="background-image:url({{ rental.galleryUrl }})"></div>
								<!-- <div class="img-container" data-original="{{ rental.galleryUrl }}"></div> -->
								<h3 class="title">Villa in {{ rental.longJSON.listing.primaryLocation.name }} with {{ rental.sleeps }} sleeps, {{ rental.bathrooms }} bathrooms, and {{ rental.bedrooms }} bedrooms</h3>
								<div class="amnetities">
									<div class="col">
										<span class="vicon sleeps"></span>
										<span class="val">{{ rental.sleeps }}</span>
									</div>
									<div class="col">
										<span class="vicon bathrooms"></span>
										<span class="val">{{ rental.bathrooms }}</span>
									</div>
									<div class="col">
										<span class="vicon bedrooms"></span>
										<span class="val">{{ rental.bedrooms }}</span>
									</div>
									<div class="col">
										<span class="val price">Â£ {{ rental.price }}</span>
									</div>
								</div>
							</a>
						</div>
{% endfor %}
					</div>
				</div>
				<div class="pagination">
					<span class="count">{{ pagination.page }} of {{ pagination.page_count }}</span>
					<div class="arrows">
						{% if pagination.prev %}
						<a href="{{ pagination.prev }}" class="prev">Prev</a>
						{% endif %}
						{% if pagination.next %}
						<a href="{{ pagination.next }}" class="next">Next</a>
						{% endif %}
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div id="villas-map"></div>
			</div>
		</div>
	</div>

	<footer>
		<div class="container">
			<div class="row">
				<div class="col-xs-18 col-sm-2 footer-logo-section">
					<a href="#" class="footer-brand"></a>
				</div>
				<div class="col-xs-18 col-sm-6 col-md-4 pull-right">
					<div class="social">
						<span class="stay-connected">Stay Connected</span>
						<a href="#"><img src="{% static "img/social-icons/facebook.png" %}" width="24" alt="StayScrape Facebook"></a>
						<a href="#"><img src="{% static "img/social-icons/twitter.png" %}" width="24" alt="StayScrape Twitter"></a>
						<a href="#"><img src="{% static "img/social-icons/linkedin.png" %}" width="24" alt="StayScrape Linkedin"></a>
						<a href="#"><img src="{% static "img/social-icons/instagram.png" %}" width="24" alt="StayScrape Instagmra"></a>
						<a href="#"><img src="{% static "img/social-icons/pinterest.png" %}" width="24" alt="StayScrape Pinterest"></a>
						<a href="#"><img src="{% static "img/social-icons/google-plus.png" %}" width="24" alt="StayScrape Google+"></a>
						<a href="#"><img src="{% static "img/social-icons/youtube.png" %}" width="24" alt="StayScrape Youtube"></a>
					</div>
				</div>
			</div>
		</div>
	</footer>

	<!-- <script src="{% static "js/jquery.min.js" %}"></script>
	<script src="{% static "js/jquery.lazy.min.js" %}"></script>
	<script>
	    $(function() {
	        $('.img-container').lazyload({
	        	effect : "fadeIn"
			});      
	    });
	</script> -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.32.1/mapbox-gl.js'></script>

<!-- <script>
    mapboxgl.accessToken = 'pk.eyJ1Ijoic3RheXNjcmFwZSIsImEiOiJjaXpjdzVpdDIxbmhtMzJxb3FzeW10d2JrIn0.CV-uNOleGhjFI01yRCaxaw';
    var geojson = {
        "type": "FeatureCollection",
        "features": [
            {
                "type": "Feature",
                "properties": {
                    "message": "Foo",
                    "iconSize": [60, 60]
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        -66.324462890625,
                        -16.024695711685304
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "message": "Bar",
                    "iconSize": [50, 50]
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        -61.2158203125,
                        -15.97189158092897
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "message": "Baz",
                    "iconSize": [40, 40]
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        -63.29223632812499,
                        -18.28151823530889
                    ]
                }
            }
        ]
    };

    var map = new mapboxgl.Map({
        container: 'villas-map',
        style: 'mapbox://styles/mapbox/streets-v9',
        center: [-65.017, -16.457],
        zoom: 5
    });

    // add markers to map
    geojson.features.forEach(function(marker) {
        // create a DOM element for the marker
        var el = document.createElement('div');
        el.className = 'marker';
        el.style.backgroundImage = 'url(https://placekitten.com/g/' + marker.properties.iconSize.join('/') + '/)';
        el.style.width = marker.properties.iconSize[0] + 'px';
        el.style.height = marker.properties.iconSize[1] + 'px';

        el.addEventListener('click', function() {
            window.alert(marker.properties.message);
        });

        // add marker to map
        new mapboxgl.Marker(el, {offset: [-marker.properties.iconSize[0] / 2, -marker.properties.iconSize[1] / 2]})
            .setLngLat(marker.geometry.coordinates)
            .addTo(map);
    });
</script> -->


</body>
</html>